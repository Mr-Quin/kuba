(this.webpackJsonpKuba=this.webpackJsonpKuba||[]).push([[0],{69:function(e,t,r){},76:function(e,t,r){"use strict";r.r(t);var n,a,c,o=r(1),i=r.n(o),u=r(20),s=r.n(u),l=(r(69),r(100)),b=r(111),d=r(77),j=r(102),f=r(4),O=r(8),h=r(7),p=r(57),m=function(e,t){return e.map((function(e,r){return e+t[r]}))},v=function(e){window.history.replaceState(null,"Kuba",e)},g=function(e){var t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)},x=r(34),y=r(16),C=function(){var e=[a.EMPTY,a.BLACK,a.WHITE,a.RED],t=e[0],r=e[1],n=e[2],c=e[3];return[[n,n,t,t,t,r,r],[n,n,t,c,t,r,r],[t,t,c,c,c,t,t],[t,c,c,c,c,c,t],[t,t,c,c,c,t,t],[r,r,t,c,t,n,n],[r,r,t,t,t,n,n]]};!function(e){e[e.EMPTY=-1]="EMPTY",e[e.WHITE=0]="WHITE",e[e.BLACK=1]="BLACK",e[e.RED=2]="RED"}(a||(a={})),function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.UP=2]="UP",e[e.DOWN=3]="DOWN"}(c||(c={}));var E=(n={},Object(h.a)(n,a.WHITE,"w"),Object(h.a)(n,a.BLACK,"b"),Object(h.a)(n,a.RED,"r"),Object(h.a)(n,a.EMPTY,""),n),w={w:a.WHITE,b:a.BLACK,r:a.RED},B=[[0,-1],[0,1],[-1,0],[1,0]],M=Object(p.a)((function(e,t){var r;return{currentBoard:C(),simBoard:C(),boardHistory:[],winner:null,errorMessage:{message:"",update:0},turn:1,captures:(r={},Object(h.a)(r,a.BLACK,0),Object(h.a)(r,a.WHITE,0),r),currentPlayer:null,makeMove:function(r,n){var c=t(),o=c.getMarble,i=c.applySim,u=c.discardSim,s=c.currentPlayer,l=c.shiftMarble,b=c.countMarble,d=c.boardHistory,j=c.validateBoard,f=c.validateMove,p=c.modifyCapture,g=c.toString,x=o(r),y=function(e){return[function(t){return m(B[e],t)},function(t){return m(B[e].map((function(e){return-e})),t)}]}(n),C=Object(O.a)(y,2),E=C[0],w=C[1];try{f(w(r),x)}catch(I){return void e({errorMessage:{message:I.toString(),update:Math.random()}})}l(r,E);try{j(x)}catch(I){return e({errorMessage:{message:I.toString(),update:Math.random()}}),void u()}var M=function(e){var t;return(t={},Object(h.a)(t,a.WHITE,a.BLACK),Object(h.a)(t,a.BLACK,a.WHITE),t)[e]}(x),T=b(t().currentBoard),S=b(t().simBoard),k=T[M]-S[M],P=T[a.RED]-S[a.RED],H=0===k&&0===P;d.push({board:t().currentBoard,player:s,marbleChange:P}),i(),v(g()),p(x,P),(!S[M]||t().captures[x]>=7)&&e({winner:x}),e((function(e){return{turn:e.turn+1}})),(null===s||H)&&e({currentPlayer:M})},undo:function(){var r=t(),n=r.turn,a=r.boardHistory,c=r.modifyCapture,o=r.toString;if(1!==n){var i=a.pop(),u=i.board,s=i.player,l=i.marbleChange;e({currentPlayer:s,currentBoard:u,simBoard:u,turn:n-1,winner:null}),c(s,-l),v(o())}},applySim:function(){e({currentBoard:t().simBoard})},discardSim:function(){e({simBoard:t().currentBoard})},shiftMarble:function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.EMPTY,c=t().getMarble(e);c===a.EMPTY||t().shiftMarble(r(e),r,c),t().setMarble(e,n)},getMarble:function(e){var r=t().simBoard;try{var n;return null!==(n=r[e[0]][e[1]])&&void 0!==n?n:a.EMPTY}catch(c){return a.EMPTY}},setMarble:function(r,n){var a=t().simBoard;try{if(void 0!==a[r[0]][r[1]]){var c=JSON.parse(JSON.stringify(a));c[r[0]][r[1]]=n,e({simBoard:c})}}catch(o){return}},countMarble:function(e){return e.flat().reduce((function(e,t){return void 0===e[t]?Object(f.a)(Object(f.a)({},e),{},Object(h.a)({},t,1)):Object(f.a)(Object(f.a)({},e),{},Object(h.a)({},t,e[t]+1))}),{})},modifyCapture:function(r,n){var a=t().captures,c=a[r]+n;e({captures:Object(f.a)(Object(f.a)({},a),{},Object(h.a)({},r,c))})},findMoves:function(e){return[[0,0],0]},validateBoard:function(e){var r,n,a,c=t(),o=c.boardHistory,i=c.simBoard,u=c.currentBoard,s=c.countMarble,l=s(u);if(s(i)[e]<l[e])throw Error("Cannot push off own marble");if(!(o.length<2)&&(r=i,n=(a=o,a[a.length-1]).board,JSON.stringify(r)===JSON.stringify(n)))throw Error("Cannot revert opponent's move")},validateMove:function(e,r){var n=t(),c=n.winner,o=n.currentPlayer,i=n.getMarble;if(null!==c)throw Error("Game already over");if(i(e)!==a.EMPTY)throw Error("Cannot push in this direction");if(null!==o&&r!==o)throw Error("".concat(g(a[o]),"'s turn"))},init:function(){var t,r=window.location.pathname.slice(1);(t=r,new Promise((function(e,r){var n=[];atob(t).split("-").forEach((function(e){var t=[];e.split("").forEach((function(e){if(Number.isInteger(parseInt(e))){var r=new Array(parseInt(e)).fill(a.EMPTY);t.push.apply(t,Object(y.a)(r))}else t.push(w[e])})),7!==t.length&&r("Incorrect notation"),n.push(t)})),7!==n.length&&r("Incorrect notation"),e(n)}))).then((function(t){e({currentBoard:t,simBoard:t})})).catch((function(){e({currentBoard:C(),simBoard:C()})})).finally((function(){var t;e({boardHistory:[],winner:null,errorMessage:{message:"",update:0},turn:1,captures:(t={},Object(h.a)(t,a.BLACK,0),Object(h.a)(t,a.WHITE,0),t),currentPlayer:null})}))},reset:function(){v("/"),t().init()},toString:function(){return function(e){var t,r="",n=0,c=Object(x.a)(e);try{for(c.s();!(t=c.n()).done;){var o,i=t.value,u=Object(x.a)(i);try{for(u.s();!(o=u.n()).done;){var s=o.value;s===a.EMPTY?n+=1:n>0?(r+=n.toString(),r+=E[s],n=0):r+=E[s]}}catch(l){u.e(l)}finally{u.f()}n>0&&(r+=n.toString(),n=0),r+="-"}}catch(l){c.e(l)}finally{c.f()}return btoa(r.slice(0,-1))}(t().currentBoard)}}})),T=r(59),S=r(48),k=r(5),P=Object(l.a)((function(){return Object(b.a)({root:{background:function(e){switch(e.color){case"red":return"linear-gradient(135deg, #FE5B55 30%, #CC1E23 90%)";case"black":return"linear-gradient(135deg, black 30%, #666 90%)";case"white":return"linear-gradient(135deg, white 30%, #ddd 90%)";default:return"none"}},border:0,borderRadius:"50%",aspectRatio:"1",touchAction:"none",cursor:function(e){return"empty"===e.color||"red"===e.color?"default":"pointer"},boxShadow:function(e){switch(e.color){case"red":return"0 3px 5px 2px rgba(255, 105, 135, .3)";case"black":return"0 3px 5px 2px rgba(25, 0, 10, .3)";case"white":return"0 3px 5px 2px rgba(0, 0, 0, .3)";default:return"none"}},userSelect:"none"}})})),H=function(e){return e.makeMove},I=Object(S.animated)(d.a),L=Object(o.memo)((function(e){var t=e.color,r=e.posRow,n=e.posCol,a=P(e),i=M(H),u=Object(o.useCallback)((function(e){i([r,n],e)}),[r,n,i]),s=Object(S.useSpring)((function(){return{x:0,y:0}})),l=Object(O.a)(s,2),b=l[0],d=b.x,j=b.y,h=l[1],p=Object(T.a)((function(e){var r=e.down,n=Object(O.a)(e.movement,2),a=n[0],o=n[1],i=e.distance;if("black"===t||"white"===t){var s=i>30,l=function(e){var t=Object(O.a)(e,2),r=t[0],n=t[1];return 0===r?n>0?c.DOWN:c.UP:r>0?c.RIGHT:c.LEFT}([a,o]);h({x:r?a:0,y:r?o:0}),!r&&s&&u(l)}}),{lockDirection:!0});return Object(k.jsx)(I,Object(f.a)(Object(f.a)({className:a.root},p()),{},{style:{x:d,y:j}}))})),N=r(60),R=r.n(N),W=Object(l.a)((function(e){return Object(b.a)({grid:{userSelect:"none"},paper:{padding:e.spacing(1),color:e.palette.text.secondary}})})),A=function(e){return e.currentBoard},D=function(){var e=W(),t=M(A,R.a);return Object(k.jsx)(k.Fragment,{children:Object(k.jsx)(j.a,{className:e.grid,container:!0,children:t.map((function(t,r){return Object(k.jsx)(j.a,{container:!0,item:!0,spacing:0,children:t.map((function(t,n){return Object(k.jsx)(j.a,{item:!0,xs:!0,children:Object(k.jsx)(d.a,{className:e.paper,variant:"outlined",square:!0,children:Object(k.jsx)(L,{color:a[t].toLowerCase(),posRow:r,posCol:n})})},n)}))},r)}))})})},K=r(106),F=r(104),Y=r(105),J=r(110),U=r(107),z=r(112),G=r(109),q=r(103),Q=Object(o.memo)((function(){var e=M(Object(o.useCallback)((function(e){return[e.undo,e.boardHistory]}),[])),t=Object(O.a)(e,2),r=t[0],n=t[1];return Object(k.jsx)(q.a,{variant:"contained",disabled:0===n.length,onClick:r,children:"Undo"})})),V=Object(o.memo)((function(){var e=M(Object(o.useCallback)((function(e){return e.reset}),[]));return Object(k.jsx)(q.a,{variant:"contained",color:"secondary",onClick:e,children:"Reset"})})),X=Object(o.memo)((function(){var e=Object(o.useState)(!1),t=Object(O.a)(e,2),r=t[0],n=t[1],a=Object(o.useCallback)((function(){navigator.clipboard.writeText(window.location.href).then((function(){n(!0),console.log("Copied to clipboard")}))}),[]),c=Object(o.useCallback)((function(){n(!1)}),[]);return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(q.a,{variant:"contained",onClick:a,children:"Export game state"}),Object(k.jsx)(J.a,{open:r,autoHideDuration:2e3,onClose:c,anchorOrigin:{vertical:"top",horizontal:"right"},children:Object(k.jsx)(G.a,{onClose:c,severity:"success",children:"Copied to clipboard"})})]})})),Z=Object(l.a)({root:{outline:"none",boxShadow:"none"},title:{fontSize:"3em"},backdrop:{zIndex:999,color:"white"}}),$=function(){var e=Z(),t=Object(o.useState)(!1),r=Object(O.a)(t,2),n=r[0],c=r[1],i=Object(o.useState)(!1),u=Object(O.a)(i,2),s=u[0],l=u[1],b=M(Object(o.useCallback)((function(e){return[e.turn,e.currentPlayer,e.errorMessage,e.captures,e.winner]}),[])),d=Object(O.a)(b,5),j=d[0],f=d[1],h=d[2],p=d[3],m=d[4];Object(o.useEffect)((function(){h.message?c(!0):c(!1),null!==m&&l(!0)}),[h,m]);var v=Object(o.useCallback)((function(e,t){"clickaway"!==t&&c(!1)}),[]),x=Object(o.useCallback)((function(){l(!1)}),[]);return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)(F.a,{className:e.root,variant:"elevation",children:[Object(k.jsxs)(Y.a,{children:[Object(k.jsx)(K.a,{className:e.title,variant:"h1",component:"h1",gutterBottom:!0,children:"Kuba"}),Object(k.jsxs)(K.a,{children:["Turn ",j,","," ",null!==f?g(a[f]):"Anyone"]}),Object(k.jsxs)(K.a,{children:["Captures: White: ",p[a.WHITE],", Black: ",p[a.BLACK]]}),Object(k.jsx)(J.a,{open:n,autoHideDuration:2e3,onClose:v,anchorOrigin:{vertical:"top",horizontal:"center"},children:Object(k.jsx)(G.a,{onClose:v,severity:"warning",children:h.message})})]}),Object(k.jsxs)(U.a,{children:[Object(k.jsx)(Q,{}),Object(k.jsx)(V,{}),Object(k.jsx)(X,{})]})]}),Object(k.jsx)(z.a,{className:e.backdrop,open:s,onClick:x,children:Object(k.jsxs)(K.a,{variant:"h1",component:"h1",children:[a[m]," wins"]})})]})},_=r(108),ee=Object(l.a)({root:{}});var te=function(){var e=ee(),t=M((function(e){return e.init}));return Object(o.useEffect)((function(){t()}),[t]),Object(k.jsxs)(_.a,{className:e.root,maxWidth:"sm",children:[Object(k.jsx)($,{}),Object(k.jsx)(D,{})]})},re=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,114)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;r(e),n(e),a(e),c(e),o(e)}))};s.a.render(Object(k.jsx)(i.a.StrictMode,{children:Object(k.jsx)(te,{})}),document.getElementById("root")),re()}},[[76,1,2]]]);