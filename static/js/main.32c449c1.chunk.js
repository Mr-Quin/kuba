(this.webpackJsonpKuba=this.webpackJsonpKuba||[]).push([[0],{69:function(e,t,r){},76:function(e,t,r){"use strict";r.r(t);var n,a,c,o,i,u=r(1),s=r.n(u),l=r(20),b=r.n(l),d=(r(69),r(100)),j=r(111),f=r(77),O=r(102),p=r(5),h=r(16),m=r(6),v=r(7),g=r(57),y=function(e){return e.map((function(e){return-e}))},x=function(e,t){return e.map((function(e,r){return e+t[r]}))},E=function(e){window.location.hash=null!==e&&void 0!==e?e:""},C=function(e){var t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)},B=function(){var e=[o.EMPTY,o.BLACK,o.WHITE,o.RED],t=e[0],r=e[1],n=e[2],a=e[3];return[[n,n,t,t,t,r,r],[n,n,t,a,t,r,r],[t,t,a,a,a,t,t],[t,a,a,a,a,a,t],[t,t,a,a,a,t,t],[r,r,t,a,t,n,n],[r,r,t,t,t,n,n]]},w=function(e){var t="",r=0;return e.forEach((function(e){e.forEach((function(e){e===o.EMPTY?r+=1:r>0?(t+=r.toString(),t+=k[e],r=0):t+=k[e]})),r>0&&(t+=r.toString(),r=0),t+="/"})),t.slice(0,-1)},M=function(e){return Object.entries(e).map((function(e){var t=Object(m.a)(e,2),r=t[0],n=t[1];return k[parseInt(r)]+n.toString()})).join("")},P=function(e){return new Promise((function(t,r){var n=[];e.split("/").forEach((function(e){var t=[];e.split("").forEach((function(e){if(Number.isInteger(parseInt(e))){var r=new Array(parseInt(e)).fill(o.EMPTY);t.push.apply(t,Object(h.a)(r))}else t.push(H[e])})),7!==t.length&&r("Board: Incorrect notation"),n.push(t)})),7!==n.length&&r("Board: Incorrect notation"),t(n)}))},T=function(e){return new Promise((function(t,r){var n,a;4!==e.length&&r("Capture: Incorrect notation"),t(Object.fromEntries((n=e.split(""),a=2,Array.from({length:Math.ceil(n.length/a)},(function(e,t){return n.slice(t*a,t*a+a)}))).map((function(e){return[H[e[0]],parseInt(e[1])]}))))}))};!function(e){e[e.EMPTY=-1]="EMPTY",e[e.WHITE=0]="WHITE",e[e.BLACK=1]="BLACK",e[e.RED=2]="RED"}(o||(o={})),function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.UP=2]="UP",e[e.DOWN=3]="DOWN"}(i||(i={}));var k=(n={},Object(v.a)(n,o.WHITE,"w"),Object(v.a)(n,o.BLACK,"b"),Object(v.a)(n,o.RED,"r"),Object(v.a)(n,o.EMPTY,""),n),H={w:o.WHITE,b:o.BLACK,r:o.RED},I=(a={},Object(v.a)(a,i.LEFT,[0,-1]),Object(v.a)(a,i.RIGHT,[0,1]),Object(v.a)(a,i.UP,[-1,0]),Object(v.a)(a,i.DOWN,[1,0]),a),S=(c={},Object(v.a)(c,o.WHITE,o.BLACK),Object(v.a)(c,o.BLACK,o.WHITE),c),L=Object(g.a)((function(e,t){var r;return{currentBoard:B(),simBoard:B(),boardHistory:[],winner:null,currentPlayer:null,errorMessage:{message:"",update:0},turn:1,captures:(r={},Object(v.a)(r,o.BLACK,0),Object(v.a)(r,o.WHITE,0),r),makeMove:function(r){var n,a=t(),c=a.applySim,i=a.canMakeMove,u=a.countMarble,s=a.currentPlayer,l=a.discardSim,b=a.encodeGame,d=a.getMarble,j=a.modifyCapture,f=a.pushHistory,O=a.setError,p=a.shiftMarble,h=a.validateBoard,v=Object(m.a)(r,2),g=v[0],C=v[1],B=d(g),w=(n=C,[function(e){return x(I[n],e)},function(e){return x(y(I[n]),e)}]),M=Object(m.a)(w,2),P=M[0],T=i((0,M[1])(g),B);if(T)O(T);else{p(g,P);try{h(B)}catch(A){return O(A),void l()}var k=S[B],H=u(t().currentBoard),L=u(t().simBoard),N=H[k]-L[k],R=H[o.RED]-L[o.RED],W=0===N&&0===R;f({board:t().currentBoard,player:s,marbleChange:R}),c(),j(B,R),(!L[k]||t().captures[B]>=7)&&e({winner:B}),e((function(e){return{turn:e.turn+1}})),(null===s||W)&&e({currentPlayer:k}),E(b())}},undo:function(){var r=t(),n=r.turn,a=r.popHistory,c=r.modifyCapture,o=r.encodeGame;if(1!==n){var i=a(),u=i.board,s=i.player,l=i.marbleChange;e({currentPlayer:s,currentBoard:u,simBoard:u,turn:n-1,winner:null}),c(s,-l),E(o())}},pushHistory:function(t){e((function(e){return{boardHistory:[].concat(Object(h.a)(e.boardHistory),[t])}}))},popHistory:function(){var r=t().boardHistory,n=r.slice(-1)[0];return e({boardHistory:r.slice(0,-1)}),n},applySim:function(){e({currentBoard:t().simBoard})},discardSim:function(){e({simBoard:t().currentBoard})},shiftMarble:function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.EMPTY,a=t(),c=a.getMarble,i=a.setMarble,u=a.shiftMarble,s=c(e);s===o.EMPTY||u(r(e),r,s),i(e,n)},getMarble:function(e){var r=t().simBoard;try{var n;return null!==(n=r[e[0]][e[1]])&&void 0!==n?n:o.EMPTY}catch(a){return o.EMPTY}},setMarble:function(r,n){var a=t().simBoard;try{if(void 0!==a[r[0]][r[1]]){var c=JSON.parse(JSON.stringify(a));c[r[0]][r[1]]=n,e({simBoard:c})}}catch(o){return}},countMarble:function(e){return e.flat().reduce((function(e,t){return void 0===e[t]?Object(p.a)(Object(p.a)({},e),{},Object(v.a)({},t,1)):Object(p.a)(Object(p.a)({},e),{},Object(v.a)({},t,e[t]+1))}),{})},modifyCapture:function(e,r){t().captures[e]+=r},findMoves:function(e){var r=t(),n=r.currentBoard,a=r.isValidMove;return n.forEach((function(t,r){t.forEach((function(t,n){t===e&&Object.values(i).forEach((function(e){Number.isInteger(parseInt(e))&&console.log([r,n],e,a([[r,n],e]))}))}))})),[[0,0],0]},validateBoard:function(e){var r,n,a,c=t(),o=c.boardHistory,i=c.simBoard,u=c.currentBoard,s=c.countMarble,l=s(u);if(s(i)[e]<l[e])throw Error("Cannot push off own marble");if(!(o.length<2)&&(r=i,n=(a=o,a[a.length-1]).board,JSON.stringify(r)===JSON.stringify(n)))throw Error("Cannot revert opponent's move")},canMakeMove:function(e,r){var n=t(),a=n.winner,c=n.currentPlayer,i=n.getMarble;return null!==a?"Game already over":null!==c&&r!==c?"".concat(C(o[c]),"'s turn"):i(e)!==o.EMPTY?"Cannot push in this direction":void 0},isValidMove:function(e){var r=Object(m.a)(e,2),n=r[0],a=r[1];return(0,t().getMarble)(x(n,y(I[a])))===o.EMPTY},setError:function(t){e({errorMessage:{message:t.toString(),update:Math.random()}})},init:function(){var t,r=window.location.hash.slice(1);(t=r,new Promise((function(e,r){var n=atob(t).split("-"),a=Object(m.a)(n,2),c=a[0],o=a[1].split(" "),i=Object(m.a)(o,3),u=i[0],s=i[1],l=i[2],b=void 0===l?null:H[l],d=parseInt(s);Promise.all([P(c),T(u)]).then((function(t){var r=Object(m.a)(t,2),n=r[0],a=r[1];e({board:n,captures:a,turn:d,currentPlayer:b})})).catch(r)}))).then((function(t){var r=t.board,n=t.currentPlayer,a=t.turn,c=t.captures;e({currentBoard:r,simBoard:r,turn:a,currentPlayer:n,captures:c})})).catch((function(){var t;e({currentBoard:B(),simBoard:B(),turn:1,currentPlayer:null,captures:(t={},Object(v.a)(t,o.BLACK,0),Object(v.a)(t,o.WHITE,0),t)})})).finally((function(){e({winner:null,boardHistory:[],errorMessage:{message:"",update:0}})}))},reset:function(){E(),t().init()},encodeGame:function(){var e=t();return function(e){var t=e.board,r=e.captures,n=e.currentPlayer,a=e.turn,c=w(t),o=M(r),i=k[n],u=[c,[o,a.toString(),i].join(" ")].join("-");return btoa(u)}({board:e.currentBoard,captures:e.captures,turn:e.turn,currentPlayer:e.currentPlayer})}}})),N=r(59),R=r(47),W=r(4),A=Object(d.a)((function(){return Object(j.a)({root:{background:function(e){switch(e.color){case"red":return"linear-gradient(135deg, #FE5B55 30%, #CC1E23 90%)";case"black":return"linear-gradient(135deg, black 30%, #666 90%)";case"white":return"linear-gradient(135deg, white 30%, #ddd 90%)";default:return"none"}},border:0,borderRadius:"50%",aspectRatio:"1",touchAction:"none",cursor:function(e){return"empty"===e.color||"red"===e.color?"default":"pointer"},boxShadow:function(e){switch(e.color){case"red":return"0 3px 5px 2px rgba(255, 105, 135, .3)";case"black":return"0 3px 5px 2px rgba(25, 0, 10, .3)";case"white":return"0 3px 5px 2px rgba(0, 0, 0, .3)";default:return"none"}},userSelect:"none"}})})),D=function(e){return e.makeMove},K=Object(R.animated)(f.a),F=Object(u.memo)((function(e){var t=e.color,r=e.posRow,n=e.posCol,a=A(e),c=L(D),o=Object(u.useCallback)((function(e){c([[r,n],e])}),[r,n,c]),s=Object(R.useSpring)((function(){return{x:0,y:0}})),l=Object(m.a)(s,2),b=l[0],d=b.x,j=b.y,f=l[1],O=Object(N.a)((function(e){var r=e.down,n=Object(m.a)(e.movement,2),a=n[0],c=n[1],u=e.distance;if("black"===t||"white"===t){var s=u>30,l=function(e){var t=Object(m.a)(e,2),r=t[0],n=t[1];return 0===r?n>0?i.DOWN:i.UP:r>0?i.RIGHT:i.LEFT}([a,c]);f({x:r?a:0,y:r?c:0}),!r&&s&&o(l)}}),{lockDirection:!0});return Object(W.jsx)(K,Object(p.a)(Object(p.a)({className:a.root},O()),{},{style:{x:d,y:j}}))})),Y=r(60),G=r.n(Y),J=Object(d.a)((function(e){return Object(j.a)({grid:{userSelect:"none"},paper:{padding:e.spacing(1),color:e.palette.text.secondary}})})),U=function(e){return e.currentBoard},z=function(){var e=J(),t=L(U,G.a);return Object(W.jsx)(W.Fragment,{children:Object(W.jsx)(O.a,{className:e.grid,container:!0,children:t.map((function(t,r){return Object(W.jsx)(O.a,{container:!0,item:!0,spacing:0,children:t.map((function(t,n){return Object(W.jsx)(O.a,{item:!0,xs:!0,children:Object(W.jsx)(f.a,{className:e.paper,variant:"outlined",square:!0,children:Object(W.jsx)(F,{color:o[t].toLowerCase(),posRow:r,posCol:n})})},n)}))},r)}))})})},V=r(106),q=r(104),Q=r(105),X=r(110),Z=r(107),$=r(112),_=r(109),ee=r(103),te=Object(u.memo)((function(){var e=L(Object(u.useCallback)((function(e){return[e.undo,e.boardHistory]}),[])),t=Object(m.a)(e,2),r=t[0],n=t[1];return Object(W.jsx)(ee.a,{variant:"contained",disabled:0===n.length,onClick:r,children:"Undo"})})),re=Object(u.memo)((function(){var e=L(Object(u.useCallback)((function(e){return e.reset}),[]));return Object(W.jsx)(ee.a,{variant:"contained",color:"secondary",onClick:e,children:"Reset"})})),ne=Object(u.memo)((function(){var e=Object(u.useState)(!1),t=Object(m.a)(e,2),r=t[0],n=t[1],a=Object(u.useCallback)((function(){navigator.clipboard.writeText(window.location.href).then((function(){n(!0),console.log("Copied to clipboard")}))}),[]),c=Object(u.useCallback)((function(){n(!1)}),[]);return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(ee.a,{variant:"contained",onClick:a,children:"Export game state"}),Object(W.jsx)(X.a,{open:r,autoHideDuration:2e3,onClose:c,anchorOrigin:{vertical:"top",horizontal:"right"},children:Object(W.jsx)(_.a,{onClose:c,severity:"success",children:"Copied to clipboard"})})]})})),ae=Object(d.a)({root:{outline:"none",boxShadow:"none"},title:{fontSize:"3em"},backdrop:{zIndex:999,color:"white"}}),ce=function(){var e=ae(),t=Object(u.useState)(!1),r=Object(m.a)(t,2),n=r[0],a=r[1],c=Object(u.useState)(!1),i=Object(m.a)(c,2),s=i[0],l=i[1],b=L(Object(u.useCallback)((function(e){return[e.turn,e.currentPlayer,e.errorMessage,e.captures,e.winner]}),[])),d=Object(m.a)(b,5),j=d[0],f=d[1],O=d[2],p=d[3],h=d[4];Object(u.useEffect)((function(){O.message?a(!0):a(!1),null!==h&&l(!0)}),[O,h]);var v=Object(u.useCallback)((function(e,t){"clickaway"!==t&&a(!1)}),[]),g=Object(u.useCallback)((function(){l(!1)}),[]);return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(q.a,{className:e.root,variant:"elevation",children:[Object(W.jsxs)(Q.a,{children:[Object(W.jsx)(V.a,{className:e.title,variant:"h1",component:"h1",gutterBottom:!0,children:"Kuba"}),Object(W.jsxs)(V.a,{children:["Turn ",j,","," ",null!==f?C(o[f]):"Anyone"]}),Object(W.jsxs)(V.a,{children:["Captures: White: ",p[o.WHITE],", Black: ",p[o.BLACK]]}),Object(W.jsx)(X.a,{open:n,autoHideDuration:2e3,onClose:v,anchorOrigin:{vertical:"top",horizontal:"center"},children:Object(W.jsx)(_.a,{onClose:v,severity:"warning",children:O.message})})]}),Object(W.jsxs)(Z.a,{children:[Object(W.jsx)(te,{}),Object(W.jsx)(re,{}),Object(W.jsx)(ne,{})]})]}),Object(W.jsx)($.a,{className:e.backdrop,open:s,onClick:g,children:Object(W.jsxs)(V.a,{variant:"h1",component:"h1",children:[o[h]," wins"]})})]})},oe=r(108),ie=Object(d.a)({root:{}});var ue=function(){var e=ie(),t=L((function(e){return e.init}));return Object(u.useEffect)((function(){t()}),[t]),Object(W.jsxs)(oe.a,{className:e.root,maxWidth:"sm",children:[Object(W.jsx)(ce,{}),Object(W.jsx)(z,{})]})},se=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,114)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;r(e),n(e),a(e),c(e),o(e)}))};b.a.render(Object(W.jsx)(s.a.StrictMode,{children:Object(W.jsx)(ue,{})}),document.getElementById("root")),se()}},[[76,1,2]]]);