(this.webpackJsonpKuba=this.webpackJsonpKuba||[]).push([[0],{69:function(e,r,t){},76:function(e,r,t){"use strict";t.r(r);var n,a,c,o=t(1),i=t.n(o),u=t(20),s=t.n(u),l=(t(69),t(100)),b=t(111),d=t(77),j=t(102),f=t(4),O=t(6),p=t(8),h=t(57),v=function(e,r){return e.map((function(e,t){return e+r[t]}))},m=function(e){window.location.hash=null!==e&&void 0!==e?e:""},g=function(e){var r=e.toLowerCase();return r.charAt(0).toUpperCase()+r.slice(1)},y=t(16),x=t(34),C=function(){var e=[a.EMPTY,a.BLACK,a.WHITE,a.RED],r=e[0],t=e[1],n=e[2],c=e[3];return[[n,n,r,r,r,t,t],[n,n,r,c,r,t,t],[r,r,c,c,c,r,r],[r,c,c,c,c,c,r],[r,r,c,c,c,r,r],[t,t,r,c,r,n,n],[t,t,r,r,r,n,n]]},E=function(e){var r,t="",n=0,c=Object(x.a)(e);try{for(c.s();!(r=c.n()).done;){var o,i=r.value,u=Object(x.a)(i);try{for(u.s();!(o=u.n()).done;){var s=o.value;s===a.EMPTY?n+=1:n>0?(t+=n.toString(),t+=P[s],n=0):t+=P[s]}}catch(l){u.e(l)}finally{u.f()}n>0&&(t+=n.toString(),n=0),t+="/"}}catch(l){c.e(l)}finally{c.f()}return t.slice(0,-1)},w=function(e){return Object.entries(e).map((function(e){var r=Object(O.a)(e,2),t=r[0],n=r[1];return P[parseInt(t)]+n.toString()})).join("")},B=function(e){return new Promise((function(r,t){var n=[];e.split("/").forEach((function(e){var r=[];e.split("").forEach((function(e){if(Number.isInteger(parseInt(e))){var t=new Array(parseInt(e)).fill(a.EMPTY);r.push.apply(r,Object(y.a)(t))}else r.push(T[e])})),7!==r.length&&t("Board: Incorrect notation"),n.push(r)})),7!==n.length&&t("Board: Incorrect notation"),r(n)}))},M=function(e){return new Promise((function(r,t){var n,a;4!==e.length&&t("Capture: Incorrect notation"),r(Object.fromEntries((n=e.split(""),a=2,Array.from({length:Math.ceil(n.length/a)},(function(e,r){return n.slice(r*a,r*a+a)}))).map((function(e){return[T[e[0]],parseInt(e[1])]}))))}))};!function(e){e[e.EMPTY=-1]="EMPTY",e[e.WHITE=0]="WHITE",e[e.BLACK=1]="BLACK",e[e.RED=2]="RED"}(a||(a={})),function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.UP=2]="UP",e[e.DOWN=3]="DOWN"}(c||(c={}));var P=(n={},Object(p.a)(n,a.WHITE,"w"),Object(p.a)(n,a.BLACK,"b"),Object(p.a)(n,a.RED,"r"),Object(p.a)(n,a.EMPTY,""),n),T={w:a.WHITE,b:a.BLACK,r:a.RED},k=[[0,-1],[0,1],[-1,0],[1,0]],I=Object(h.a)((function(e,r){var t;return{currentBoard:C(),simBoard:C(),boardHistory:[],winner:null,errorMessage:{message:"",update:0},turn:1,captures:(t={},Object(p.a)(t,a.BLACK,0),Object(p.a)(t,a.WHITE,0),t),currentPlayer:null,makeMove:function(t,n){var c=r(),o=c.getMarble,i=c.applySim,u=c.discardSim,s=c.currentPlayer,l=c.shiftMarble,b=c.countMarble,d=c.boardHistory,j=c.validateBoard,f=c.validateMove,h=c.modifyCapture,g=c.encode,y=c.setError,x=o(t),C=function(e){return[function(r){return v(k[e],r)},function(r){return v(k[e].map((function(e){return-e})),r)}]}(n),E=Object(O.a)(C,2),w=E[0],B=E[1];try{f(B(t),x)}catch(L){return void y(L)}l(t,w);try{j(x)}catch(L){return y(L),void u()}var M=function(e){var r;return(r={},Object(p.a)(r,a.WHITE,a.BLACK),Object(p.a)(r,a.BLACK,a.WHITE),r)[e]}(x),P=b(r().currentBoard),T=b(r().simBoard),I=P[M]-T[M],S=P[a.RED]-T[a.RED],H=0===I&&0===S;d.push({board:r().currentBoard,player:s,marbleChange:S}),i(),h(x,S),(!T[M]||r().captures[x]>=7)&&e({winner:x}),e((function(e){return{turn:e.turn+1}})),(null===s||H)&&e({currentPlayer:M}),m(g())},undo:function(){var t=r(),n=t.turn,a=t.boardHistory,c=t.modifyCapture,o=t.encode;if(1!==n){var i=a.pop(),u=i.board,s=i.player,l=i.marbleChange;e({currentPlayer:s,currentBoard:u,simBoard:u,turn:n-1,winner:null}),c(s,-l),m(o())}},applySim:function(){e({currentBoard:r().simBoard})},discardSim:function(){e({simBoard:r().currentBoard})},shiftMarble:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.EMPTY,c=r().getMarble(e);c===a.EMPTY||r().shiftMarble(t(e),t,c),r().setMarble(e,n)},getMarble:function(e){var t=r().simBoard;try{var n;return null!==(n=t[e[0]][e[1]])&&void 0!==n?n:a.EMPTY}catch(c){return a.EMPTY}},setMarble:function(t,n){var a=r().simBoard;try{if(void 0!==a[t[0]][t[1]]){var c=JSON.parse(JSON.stringify(a));c[t[0]][t[1]]=n,e({simBoard:c})}}catch(o){return}},countMarble:function(e){return e.flat().reduce((function(e,r){return void 0===e[r]?Object(f.a)(Object(f.a)({},e),{},Object(p.a)({},r,1)):Object(f.a)(Object(f.a)({},e),{},Object(p.a)({},r,e[r]+1))}),{})},modifyCapture:function(t,n){var a=r().captures,c=a[t]+n;e({captures:Object(f.a)(Object(f.a)({},a),{},Object(p.a)({},t,c))})},findMoves:function(e){return[[0,0],0]},validateBoard:function(e){var t,n,a,c=r(),o=c.boardHistory,i=c.simBoard,u=c.currentBoard,s=c.countMarble,l=s(u);if(s(i)[e]<l[e])throw Error("Cannot push off own marble");if(!(o.length<2)&&(t=i,n=(a=o,a[a.length-1]).board,JSON.stringify(t)===JSON.stringify(n)))throw Error("Cannot revert opponent's move")},validateMove:function(e,t){var n=r(),c=n.winner,o=n.currentPlayer,i=n.getMarble;if(null!==c)throw Error("Game already over");if(i(e)!==a.EMPTY)throw Error("Cannot push in this direction");if(null!==o&&t!==o)throw Error("".concat(g(a[o]),"'s turn"))},setError:function(r){e({errorMessage:{message:r.toString(),update:Math.random()}})},init:function(){var r,t=window.location.hash.slice(1);(r=t,new Promise((function(e,t){var n=atob(r).split("-"),a=Object(O.a)(n,2),c=a[0],o=a[1].split(" "),i=Object(O.a)(o,3),u=i[0],s=i[1],l=i[2],b=void 0===l?null:T[l],d=parseInt(s);Promise.all([B(c),M(u)]).then((function(r){var t=Object(O.a)(r,2),n=t[0],a=t[1];e({board:n,captures:a,turn:d,currentPlayer:b})})).catch(t)}))).then((function(r){var t=r.board,n=r.currentPlayer,a=r.turn,c=r.captures;e({currentBoard:t,simBoard:t,turn:a,currentPlayer:n,captures:c})})).catch((function(r){var t;e({currentBoard:C(),simBoard:C(),turn:1,currentPlayer:null,captures:(t={},Object(p.a)(t,a.BLACK,0),Object(p.a)(t,a.WHITE,0),t)})})).finally((function(){e({winner:null,boardHistory:[],errorMessage:{message:"",update:0}})}))},reset:function(){m(),r().init()},encode:function(){var e=r();return function(e){var r=e.board,t=e.captures,n=e.currentPlayer,a=e.turn,c=E(r),o=w(t),i=P[n],u=[c,[o,a.toString(),i].join(" ")].join("-");return btoa(u)}({board:e.currentBoard,captures:e.captures,turn:e.turn,currentPlayer:e.currentPlayer})}}})),S=t(59),H=t(48),L=t(5),A=Object(l.a)((function(){return Object(b.a)({root:{background:function(e){switch(e.color){case"red":return"linear-gradient(135deg, #FE5B55 30%, #CC1E23 90%)";case"black":return"linear-gradient(135deg, black 30%, #666 90%)";case"white":return"linear-gradient(135deg, white 30%, #ddd 90%)";default:return"none"}},border:0,borderRadius:"50%",aspectRatio:"1",touchAction:"none",cursor:function(e){return"empty"===e.color||"red"===e.color?"default":"pointer"},boxShadow:function(e){switch(e.color){case"red":return"0 3px 5px 2px rgba(255, 105, 135, .3)";case"black":return"0 3px 5px 2px rgba(25, 0, 10, .3)";case"white":return"0 3px 5px 2px rgba(0, 0, 0, .3)";default:return"none"}},userSelect:"none"}})})),N=function(e){return e.makeMove},R=Object(H.animated)(d.a),W=Object(o.memo)((function(e){var r=e.color,t=e.posRow,n=e.posCol,a=A(e),i=I(N),u=Object(o.useCallback)((function(e){i([t,n],e)}),[t,n,i]),s=Object(H.useSpring)((function(){return{x:0,y:0}})),l=Object(O.a)(s,2),b=l[0],d=b.x,j=b.y,p=l[1],h=Object(S.a)((function(e){var t=e.down,n=Object(O.a)(e.movement,2),a=n[0],o=n[1],i=e.distance;if("black"===r||"white"===r){var s=i>30,l=function(e){var r=Object(O.a)(e,2),t=r[0],n=r[1];return 0===t?n>0?c.DOWN:c.UP:t>0?c.RIGHT:c.LEFT}([a,o]);p({x:t?a:0,y:t?o:0}),!t&&s&&u(l)}}),{lockDirection:!0});return Object(L.jsx)(R,Object(f.a)(Object(f.a)({className:a.root},h()),{},{style:{x:d,y:j}}))})),D=t(60),K=t.n(D),F=Object(l.a)((function(e){return Object(b.a)({grid:{userSelect:"none"},paper:{padding:e.spacing(1),color:e.palette.text.secondary}})})),Y=function(e){return e.currentBoard},J=function(){var e=F(),r=I(Y,K.a);return Object(L.jsx)(L.Fragment,{children:Object(L.jsx)(j.a,{className:e.grid,container:!0,children:r.map((function(r,t){return Object(L.jsx)(j.a,{container:!0,item:!0,spacing:0,children:r.map((function(r,n){return Object(L.jsx)(j.a,{item:!0,xs:!0,children:Object(L.jsx)(d.a,{className:e.paper,variant:"outlined",square:!0,children:Object(L.jsx)(W,{color:a[r].toLowerCase(),posRow:t,posCol:n})})},n)}))},t)}))})})},U=t(106),z=t(104),G=t(105),q=t(110),Q=t(107),V=t(112),X=t(109),Z=t(103),$=Object(o.memo)((function(){var e=I(Object(o.useCallback)((function(e){return[e.undo,e.boardHistory]}),[])),r=Object(O.a)(e,2),t=r[0],n=r[1];return Object(L.jsx)(Z.a,{variant:"contained",disabled:0===n.length,onClick:t,children:"Undo"})})),_=Object(o.memo)((function(){var e=I(Object(o.useCallback)((function(e){return e.reset}),[]));return Object(L.jsx)(Z.a,{variant:"contained",color:"secondary",onClick:e,children:"Reset"})})),ee=Object(o.memo)((function(){var e=Object(o.useState)(!1),r=Object(O.a)(e,2),t=r[0],n=r[1],a=Object(o.useCallback)((function(){navigator.clipboard.writeText(window.location.href).then((function(){n(!0),console.log("Copied to clipboard")}))}),[]),c=Object(o.useCallback)((function(){n(!1)}),[]);return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(Z.a,{variant:"contained",onClick:a,children:"Export game state"}),Object(L.jsx)(q.a,{open:t,autoHideDuration:2e3,onClose:c,anchorOrigin:{vertical:"top",horizontal:"right"},children:Object(L.jsx)(X.a,{onClose:c,severity:"success",children:"Copied to clipboard"})})]})})),re=Object(l.a)({root:{outline:"none",boxShadow:"none"},title:{fontSize:"3em"},backdrop:{zIndex:999,color:"white"}}),te=function(){var e=re(),r=Object(o.useState)(!1),t=Object(O.a)(r,2),n=t[0],c=t[1],i=Object(o.useState)(!1),u=Object(O.a)(i,2),s=u[0],l=u[1],b=I(Object(o.useCallback)((function(e){return[e.turn,e.currentPlayer,e.errorMessage,e.captures,e.winner]}),[])),d=Object(O.a)(b,5),j=d[0],f=d[1],p=d[2],h=d[3],v=d[4];Object(o.useEffect)((function(){p.message?c(!0):c(!1),null!==v&&l(!0)}),[p,v]);var m=Object(o.useCallback)((function(e,r){"clickaway"!==r&&c(!1)}),[]),y=Object(o.useCallback)((function(){l(!1)}),[]);return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsxs)(z.a,{className:e.root,variant:"elevation",children:[Object(L.jsxs)(G.a,{children:[Object(L.jsx)(U.a,{className:e.title,variant:"h1",component:"h1",gutterBottom:!0,children:"Kuba"}),Object(L.jsxs)(U.a,{children:["Turn ",j,","," ",null!==f?g(a[f]):"Anyone"]}),Object(L.jsxs)(U.a,{children:["Captures: White: ",h[a.WHITE],", Black: ",h[a.BLACK]]}),Object(L.jsx)(q.a,{open:n,autoHideDuration:2e3,onClose:m,anchorOrigin:{vertical:"top",horizontal:"center"},children:Object(L.jsx)(X.a,{onClose:m,severity:"warning",children:p.message})})]}),Object(L.jsxs)(Q.a,{children:[Object(L.jsx)($,{}),Object(L.jsx)(_,{}),Object(L.jsx)(ee,{})]})]}),Object(L.jsx)(V.a,{className:e.backdrop,open:s,onClick:y,children:Object(L.jsxs)(U.a,{variant:"h1",component:"h1",children:[a[v]," wins"]})})]})},ne=t(108),ae=Object(l.a)({root:{}});var ce=function(){var e=ae(),r=I((function(e){return e.init}));return Object(o.useEffect)((function(){r()}),[r]),Object(L.jsxs)(ne.a,{className:e.root,maxWidth:"sm",children:[Object(L.jsx)(te,{}),Object(L.jsx)(J,{})]})},oe=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,114)).then((function(r){var t=r.getCLS,n=r.getFID,a=r.getFCP,c=r.getLCP,o=r.getTTFB;t(e),n(e),a(e),c(e),o(e)}))};s.a.render(Object(L.jsx)(i.a.StrictMode,{children:Object(L.jsx)(ce,{})}),document.getElementById("root")),oe()}},[[76,1,2]]]);