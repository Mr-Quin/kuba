(this.webpackJsonpKuba=this.webpackJsonpKuba||[]).push([[0],{82:function(e,t,n){},94:function(e,t,n){"use strict";n.r(t);var r,a,c,o,u,i,s,l,b,O,j=n(0),f=n.n(j),d=n(22),h=n.n(d),p=(n(82),n(7)),v=n(118),E=n(131),m=n(120),g=n(15),x=n(4),T=n(5),w=n(45),y=function(e){return e[e.length-1]},M=function(e,t){return e+t},N=function(e){window.location.hash=null!==e&&void 0!==e?e:""},R=function(e,t){return Array.from({length:Math.ceil(e.length/t)},(function(n,r){return e.slice(r*t,r*t+t)}))},P=function(e){var t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)};!function(e){e[e.EMPTY=-1]="EMPTY",e[e.WHITE=0]="WHITE",e[e.BLACK=1]="BLACK",e[e.RED=2]="RED"}(s||(s={})),function(e){e.LEFT="l",e.RIGHT="r",e.UP="u",e.DOWN="d"}(l||(l={})),function(e){e[e.NONE=-1]="NONE",e[e.GAME_OVER=0]="GAME_OVER",e[e.WRONG_TURN=1]="WRONG_TURN",e[e.WRONG_DIRECTION=2]="WRONG_DIRECTION",e[e.OWN_MARBLE=3]="OWN_MARBLE",e[e.NO_UNDO=4]="NO_UNDO"}(b||(b={})),function(e){e[e.OFF_GRID=-1]="OFF_GRID"}(O||(O={}));var C,I=(r={},Object(T.a)(r,b.GAME_OVER,"Game is already over"),Object(T.a)(r,b.WRONG_TURN,"Opponent's turn"),Object(T.a)(r,b.WRONG_DIRECTION,"Invalid direction"),Object(T.a)(r,b.OWN_MARBLE,"Cannot push off own marble"),Object(T.a)(r,b.NO_UNDO,"Cannot undo opponent's move"),r),k=(a={},Object(T.a)(a,s.WHITE,"w"),Object(T.a)(a,s.BLACK,"b"),Object(T.a)(a,s.RED,"r"),Object(T.a)(a,s.EMPTY,""),a),D={w:s.WHITE,b:s.BLACK,r:s.RED},W=(c={},Object(T.a)(c,l.LEFT,-1),Object(T.a)(c,l.RIGHT,1),Object(T.a)(c,l.UP,-7),Object(T.a)(c,l.DOWN,7),c),S=(o={},Object(T.a)(o,l.LEFT,new Set([0,7,14,21,28,35,42])),Object(T.a)(o,l.RIGHT,new Set([6,13,20,27,34,41,48])),Object(T.a)(o,l.UP,new Set([0,1,2,3,4,5,6])),Object(T.a)(o,l.DOWN,new Set([42,43,44,45,46,47,48])),o),A=(u={},Object(T.a)(u,s.WHITE,s.BLACK),Object(T.a)(u,s.BLACK,s.WHITE),u),G=(i={},Object(T.a)(i,l.UP,l.DOWN),Object(T.a)(i,l.DOWN,l.UP),Object(T.a)(i,l.LEFT,l.RIGHT),Object(T.a)(i,l.RIGHT,l.LEFT),i),L=function(e){return A[e]},_=function(e){var t=Object(p.a)(e,2),n=t[0],r=t[1];return S[r].has(n)},H=function(e){var t=Object(p.a)(e,2),n=t[0],r=t[1];return M(W[r],n)},F=function e(t,n){var r=Object(p.a)(t,2),a=r[0],c=r[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],u=n(a);return u===s.EMPTY?o:_([a,c])?[a].concat(Object(g.a)(o)):e([H([a,c]),c],n,[a].concat(Object(g.a)(o)))},B=function(){var e=[s.EMPTY,s.BLACK,s.WHITE,s.RED],t=e[0],n=e[1],r=e[2],a=e[3];return[r,r,t,t,t,n,n,r,r,t,a,t,n,n,t,t,a,a,a,t,t,t,a,a,a,a,a,t,t,t,a,a,a,t,t,n,n,t,a,t,r,r,n,n,t,t,t,r,r]},U=function(e,t){return Object.values(e).filter((function(e){return e.color===t})).reduce((function(e,t){var n=t.moves;return e+Object.values(n).reduce((function(e,t){return t===b.NONE?e+1:e}),0)}),0)},z=function(e){return e.reduce((function(e,t){return t===s.EMPTY?e:Object(x.a)(Object(x.a)({},e),{},Object(T.a)({},t,void 0===e[t]?1:e[t]+1))}),{})},Y=function(e){return e===s.EMPTY},K=function(e){return e.reduce((function(e,t,n){return Y(t)?e:[].concat(Object(g.a)(e),[{pos:n,color:t,id:n}])}),[])},V=function(e){return(t=e,R(t,7)).reduce((function(e,t){var n=0,r=t.reduce((function(e,t){if(t===s.EMPTY)return n+=1,e;if(n>0){var r=e+n.toString()+k[t];return n=0,r}return e+k[t]}),e);return n>0?r+n.toString()+"/":r+"/"}),"").slice(0,-1);var t},J=function(e){return Object.entries(e).map((function(e){var t=Object(p.a)(e,2),n=t[0],r=t[1];return k[parseInt(n)]+r.toString()})).join("")},q=function(e){return new Promise((function(t,n){var r=[];e.split("/").forEach((function(e){e.split("").forEach((function(e){if(Number.isInteger(parseInt(e))){var t=new Array(parseInt(e)).fill(s.EMPTY);r.push.apply(r,Object(g.a)(t))}else r.push(D[e])}))})),49!==r.length&&n("Board: Incorrect notation"),t(r)}))},Q=function(e){return new Promise((function(t,n){4!==e.length&&n("Capture: Incorrect notation"),t(Object.fromEntries(R(e.split(""),2).map((function(e){return[D[e[0]],parseInt(e[1])]}))))}))},X={allowExtraTurns:!0,board:[],boardHistory:[],captures:(C={},Object(T.a)(C,s.BLACK,0),Object(T.a)(C,s.WHITE,0),C),currentPlayer:null,errorMessage:{message:"",update:0},hash:0,hashTable:Array(49).fill(0).map((function(){var e=new Uint32Array(3);return window.crypto.getRandomValues(e),e})),moveTable:null,pieces:[],turn:1,winner:null},Z=Object(w.a)((function(e,t){return Object(x.a)(Object(x.a)({},X),{},{makeMove:function(n){var r=t(),a=r.getMarble,c=r.tryMove,o=r.preCheckMove,u=r.setError,i=r.updateRoute,s=r.updateState,l=r.propagateMove,b=Object(p.a)(n,2),O=b[0],j=b[1],f=a(O);o(n).then((function(){return F(n,a)})).then(c(n)).then(l(j)).then(e).then(s(f)).then(e).then(i).catch(u)},tryMove:function(e){var n=Object(p.a)(e,2),r=n[0],a=n[1];return function(e){var n,c,o=t(),u=o.getMarble,i=o.moveTable,s=o.checkMove,l=null===o.currentPlayer||null===i?s([r,a],e,u(r)):null!==(n=null===(c=i[r])||void 0===c?void 0:c.moves[a])&&void 0!==n?n:b.WRONG_TURN;return l!==b.NONE?Promise.reject(I[l]):Promise.resolve(e)}},propagateMove:function(e){return function(n){var r=t(),a=r.hashMove,c=r.board,o=r.pieces;(0,r.pushHistory)();var u=y(n),i=a(e)(n),l=Object(g.a)(c),b=Object(g.a)(o);return n.forEach((function(t){var n,r=_([t,e]),a=null!==(n=l[t])&&void 0!==n?n:s.EMPTY,c=M(t,W[e]),o=b.findIndex((function(e){return e.pos===t}));r?b[o]=Object(x.a)(Object(x.a)({},b[o]),{},{pos:O.OFF_GRID}):(b[o]=Object(x.a)(Object(x.a)({},b[o]),{},{pos:c}),l[c]=a)})),l[u]=s.EMPTY,Promise.resolve({hash:i,board:l,pieces:b})}},hashMove:function(e){return function(n){var r=t(),a=r.hashTable,c=r.getMarble,o=r.hash;return n.reduce((function(t,n,r){var o=c(n),u=H([n,e]);return 0===r&&_([n,e])?t^a[n][o]:t^a[n][o]^a[u][o]}),o)}},getMarble:function(e){var n;return null!==(n=t().board[e])&&void 0!==n?n:s.EMPTY},searchMoves:function(){var e=t(),n=e.pieces,r=e.checkMove,a=e.getMarble,c=Object.values(l);return n.filter((function(e){return e.color!==s.RED&&e.pos!==O.OFF_GRID})).reduce((function(e,t){var n=t.pos,o=t.color,u=c.reduce((function(e,t){var c=F([n,t],a),o=[n,t];return Object(x.a)(Object(x.a)({},e),{},Object(T.a)({},t,r(o,c)))}),{});return Object(x.a)(Object(x.a)({},e),{},Object(T.a)({},n,{color:o,moves:u}))}),{})},preCheckMove:function(e){var n=t(),r=n.getMarble,a=n.currentPlayer;return null===n.winner?null===a||r(e[0])===a?Promise.resolve(e):Promise.reject(I[b.WRONG_TURN]):Promise.reject(I[b.GAME_OVER])},checkMove:function(e,n){var r=Object(p.a)(e,2),a=r[0],c=r[1],o=t(),u=o.getMarble,i=o.hashMove,s=o.boardHistory,l=G[c],O=function(e){var t=Object(p.a)(e,2),n=t[0],r=t[1];return M(-W[r],n)}([a,c]),j=n[0],f=y(n);return Y(u(O))||_([a,l])?_([j,c])&&u(j)===u(f)?b.OWN_MARBLE:s.length>1&&i(c)(n)===y(s).hash?b.NO_UNDO:b.NONE:b.WRONG_DIRECTION},pushHistory:function(){var e=t(),n=e.boardHistory,r=e.board,a=e.pieces,c=e.currentPlayer,o=e.captures,u=e.hash;n.push({board:r,pieces:a,player:c,captures:o,hash:u})},init:function(){var n,r=window.location.hash.slice(1);(n=r,new Promise((function(e,t){var r=atob(n);r||t("Empty string");var a=r.split(" "),c=Object(p.a)(a,4),o=c[0],u=c[1],i=c[2],s=c[3],l="-"===s?null:D[s],b=parseInt(i);Promise.all([q(o),Q(u)]).then((function(t){var n=Object(p.a)(t,2),r=n[0],a=n[1];e({board:r,captures:a,turn:b,currentPlayer:l})})).catch(t)}))).then((function(n){var r=n.board,a=n.currentPlayer,c=n.turn,o=n.captures;if(e({board:r,pieces:K(r),turn:c,currentPlayer:a,captures:o}),e((function(e){return{moveTable:e.searchMoves()}})),null!==a){var u=t().searchMoves();e({moveTable:u});var i=L(a),s=U(u,i);0===U(u,a)?e({winner:i}):0===s&&e({winner:a})}})).catch((function(){var t=B();e(Object(x.a)(Object(x.a)({},X),{},{board:t,pieces:K(t)}))})).finally((function(){e((function(e){return{moveTable:e.searchMoves(),hash:(t=e.board,n=e.hashTable,t.reduce((function(e,t,r){return t!==s.EMPTY?e^n[r][t]:e}),0)),errorMessage:{message:"",update:0}};var t,n}))}))},setError:function(t){e({errorMessage:{message:t.toString(),update:Math.random()}})},toggleExtraTurn:function(){e((function(e){return{allowExtraTurns:!e.allowExtraTurns}}))},endTurn:function(){var n=t().currentPlayer;null!==n&&e({currentPlayer:L(n)})},updateState:function(e){return function(){var n,r,a=t(),c=a.boardHistory,o=a.allowExtraTurns,u=a.captures,i=a.currentPlayer,l=a.searchMoves,b=a.turn,O=a.board,j=l(),f=L(e),d=z(O),h=z(null!==(n=null===(r=y(c))||void 0===r?void 0:r.board)&&void 0!==n?n:B()),p=h[f]-d[f],v=h[s.RED]-d[s.RED],E=u[e]+v,m=!o||(null===i||0===p&&0===v),g=m?f:i,w=U(j,f),M=0===h[f]||E>=7||0===w;return Promise.resolve({currentPlayer:g,moveTable:M?null:j,winner:M?e:null,turn:m?b+1:b,captures:Object(x.a)(Object(x.a)({},u),{},Object(T.a)({},e,E))})}},undo:function(){var n=t(),r=n.turn,a=n.boardHistory,c=n.encode;if(!(r<=1)){var o=a.pop(),u=o.board,i=o.player,s=o.pieces,l=o.captures,b=o.hash;e((function(e){return{currentPlayer:i,captures:l,pieces:s,board:u,hash:b,winner:null,moveTable:null,turn:i!==e.currentPlayer?e.turn-1:e.turn}})),N(c())}},reset:function(){N(),t().init()},updateRoute:function(){return N(t().encode()),Promise.resolve()},encode:function(){var e=t();return function(e){var t=e.board,n=e.captures,r=e.currentPlayer,a=e.turn,c=V(t),o=J(n),u=null!==r?k[r]:"-",i=[c,o,a.toString(),u].join(" ");return btoa(i)}({board:e.board,captures:e.captures,turn:e.turn,currentPlayer:e.currentPlayer})}})})),$=n(95),ee=n(65),te=n(52),ne=n(6),re=Object(v.a)((function(){return Object(E.a)({root:{background:function(e){switch(e.color){case"red":return"linear-gradient(135deg, #FE5B55 30%, #CC1E23 90%)";case"black":return"linear-gradient(135deg, black 30%, #666 90%)";case"white":return"linear-gradient(135deg, white 30%, #ddd 90%)";default:return"none"}},border:0,borderRadius:"50%",aspectRatio:"1",position:"absolute",cursor:function(e){return"empty"===e.color||"red"===e.color?"default":"pointer"},boxShadow:function(e){switch(e.color){case"red":return"0 3px 5px 2px rgba(255, 105, 135, .3)";case"black":return"0 3px 5px 2px rgba(25, 0, 10, .3)";case"white":return"0 3px 5px 2px rgba(0, 0, 0, .3)";default:return"none"}},userSelect:"none",touchAction:"none","&focus":{outline:"none !important"}}})})),ae=function(e){return e.makeMove},ce=Object(te.animated)($.a),oe=Object(j.memo)((function(e){var t=e.color,n=e.pos,r=e.size,a=e.x,c=e.y,o=re(e),u=Z(ae),i=Object(j.useCallback)((function(e){u([n,e])}),[n,u]),s=Object(te.useSpring)((function(){return{from:{x:a,y:c},config:{mass:1,tension:225,friction:30}}})),b=Object(p.a)(s,2),O=b[0],f=O.x,d=O.y,h=b[1];Object(j.useEffect)((function(){h({x:a,y:c})}),[a,c,h]);var v=Object(ee.a)((function(e){var n=e.down,r=Object(p.a)(e.movement,2),o=r[0],u=r[1],s=e.distance;if("black"===t||"white"===t){var b=s>30;h({x:n?a+o:a,y:n?c+u:c}),!n&&b&&i(function(e){var t=Object(p.a)(e,2),n=t[0],r=t[1];return 0===n?r>0?l.DOWN:l.UP:n>0?l.RIGHT:l.LEFT}([o,u]))}}),{lockDirection:!0});return Object(ne.jsx)(ce,Object(x.a)(Object(x.a)({className:o.root},v()),{},{style:{x:f,y:d,width:r}}))})),ue=Object(w.a)((function(e,t){return{gridSize:0,setGridSize:function(t){return e({gridSize:t})},calcPos:function(e){var n=t().gridSize,r=n*(1-.8)/2;return{x:n*(e%7)+r,y:n*Math.floor(e/7)+r}}}})),ie=new Array(7).fill(0).map((function(){return new Array(7).fill(0)})),se=Object(v.a)((function(e){return Object(E.a)({grid:{userSelect:"none"},paper:{padding:e.spacing(1),color:e.palette.text.secondary,aspectRatio:"1"}})})),le=function(e){return e.setGridSize},be=function(){var e=se(),t=ue(le),n=Object(j.useRef)();return Object(j.useEffect)((function(){var e=function(){if(n.current){var e,r=(null===(e=n.current)||void 0===e?void 0:e.getBoundingClientRect()).width;t(r/7)}};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[n,t]),Object(ne.jsx)(m.a,{ref:n,className:e.grid,container:!0,children:ie.map((function(t,n){return Object(ne.jsx)(m.a,{container:!0,item:!0,spacing:0,children:t.map((function(t,n){return Object(ne.jsx)(m.a,{item:!0,xs:!0,children:Object(ne.jsx)($.a,{className:e.paper,variant:"outlined",square:!0})},n)}))},n)}))})},Oe=Object(v.a)((function(e){return Object(E.a)({grid:{userSelect:"none",touchAction:"none"},paper:{padding:e.spacing(1),color:e.palette.text.secondary}})})),je=function(e){return e.pieces},fe=function(){var e=Oe(),t=Z(je),n=ue(Object(j.useCallback)((function(e){return[e.gridSize,e.calcPos]}),[])),r=Object(p.a)(n,2),a=r[0],c=r[1];return Object(ne.jsxs)(m.a,{className:e.grid,container:!0,children:[Object(ne.jsx)(be,{}),t.map((function(e){if(e.pos===O.OFF_GRID)return null;var t=c(e.pos),n=t.x,r=t.y;return Object(ne.jsx)(oe,{color:s[e.color].toLowerCase(),size:.8*a,pos:e.pos,x:n,y:r},e.id)}))]})},de=n(96),he=n(124),pe=n(125),ve=n(128),Ee=n(126),me=n(133),ge=n(130),xe=n(121),Te=n(123),we=n(129),ye=Object(j.memo)((function(e){var t=Z(Object(j.useCallback)((function(e){return[e.undo,e.turn]}),[])),n=Object(p.a)(t,2),r=n[0],a=n[1];return Object(ne.jsx)(xe.a,{variant:"contained",disabled:1===a,onClick:r,children:e.children})})),Me=Object(j.memo)((function(e){var t=Z(Object(j.useCallback)((function(e){return e.reset}),[]));return Object(ne.jsx)(xe.a,{variant:"contained",color:"secondary",onClick:t,children:e.children})})),Ne=Object(j.memo)((function(e){var t=Object(j.useState)(!1),n=Object(p.a)(t,2),r=n[0],a=n[1],c=Object(j.useCallback)((function(){navigator.clipboard.writeText(window.location.href).then((function(){a(!0)}))}),[]),o=Object(j.useCallback)((function(){a(!1)}),[]);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(xe.a,{variant:"contained",onClick:c,children:e.children}),Object(ne.jsx)(ve.a,{open:r,autoHideDuration:2e3,onClose:o,anchorOrigin:{vertical:"top",horizontal:"right"},children:Object(ne.jsx)(ge.a,{onClose:o,severity:"success",children:"Copied to clipboard"})})]})})),Re=Object(j.memo)((function(e){var t=Z(Object(j.useCallback)((function(e){return[e.allowExtraTurns,e.toggleExtraTurn]}),[])),n=Object(p.a)(t,2),r=n[0],a=n[1];return Object(ne.jsx)(Te.a,{control:Object(ne.jsx)(we.a,{checked:r,onChange:a}),label:e.label})})),Pe=n(132),Ce=Object(v.a)({root:{outline:"none",boxShadow:"none"},title:{fontSize:"3em"},controls:{flexWrap:"wrap"},backdrop:{zIndex:999,color:"white"}}),Ie=function(){var e=Ce(),t=Object(j.useState)(!1),n=Object(p.a)(t,2),r=n[0],a=n[1],c=Object(j.useState)(!1),o=Object(p.a)(c,2),u=o[0],i=o[1],l=Object(Pe.a)().t,b=Z(Object(j.useCallback)((function(e){return[e.turn,e.currentPlayer,e.errorMessage,e.captures,e.winner]}),[])),O=Object(p.a)(b,5),f=O[0],d=O[1],h=O[2],v=O[3],E=O[4];Object(j.useEffect)((function(){h.message?a(!0):a(!1)}),[h]),Object(j.useEffect)((function(){null!==E&&i(!0)}),[E]);var m=Object(j.useCallback)((function(e,t){"clickaway"!==t&&a(!1)}),[]),g=Object(j.useCallback)((function(){i(!1)}),[]);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsxs)(he.a,{className:e.root,variant:"elevation",children:[Object(ne.jsxs)(pe.a,{children:[Object(ne.jsx)(de.a,{className:e.title,variant:"h1",component:"h1",gutterBottom:!0,children:l("title")}),Object(ne.jsxs)(de.a,{children:["Turn ",f,","," ",null!==d?P(s[d]):l("anyone")]}),Object(ne.jsxs)(de.a,{children:["Captures: ",l("white"),": ",v[s.WHITE],", ",l("black"),":"," ",v[s.BLACK]]}),Object(ne.jsx)(ve.a,{open:r,autoHideDuration:2e3,onClose:m,anchorOrigin:{vertical:"top",horizontal:"center"},children:Object(ne.jsx)(ge.a,{onClose:m,severity:"warning",children:h.message})})]}),Object(ne.jsxs)(Ee.a,{className:e.controls,children:[Object(ne.jsx)(ye,{children:l("undo")}),Object(ne.jsx)(Me,{children:l("reset")}),Object(ne.jsx)(Ne,{children:l("export")}),Object(ne.jsx)(Re,{label:l("allowExtra")})]})]}),Object(ne.jsx)(me.a,{className:e.backdrop,open:u,onClick:g,children:Object(ne.jsxs)(de.a,{variant:"h1",component:"h1",children:[s[E]," wins"]})})]})},ke=n(127),De=n(54),We=n(41);De.a.use(We.e).init({resources:{en:{translation:{title:"Kuba",black:"Black",white:"White",anyone:"Anyone",undo:"Undo",reset:"Reset",export:"Export",allowExtra:"Allow extra turn"}}},lng:"en",fallbackLng:"en",interpolation:{escapeValue:!1}}).then();De.a;var Se=function(){var e=Z((function(e){return e.init}));return Object(j.useEffect)((function(){e()}),[e]),Object(ne.jsxs)(ke.a,{maxWidth:"sm",children:[Object(ne.jsx)(Ie,{}),Object(ne.jsx)(fe,{})]})},Ae=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,135)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))};h.a.render(Object(ne.jsx)(f.a.StrictMode,{children:Object(ne.jsx)(Se,{})}),document.getElementById("root")),Ae()}},[[94,1,2]]]);